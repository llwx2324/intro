<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯” | åˆ˜æ–‡é‘«-ä¸ªäººåšå®¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”ã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”">
<meta property="og:url" content="https://llwx2324.github.io/blog/2025/11/05/Spring%20AMQP%20%E4%B8%8B%20Publisher%20Confirms%20%E5%92%8C%20Publisher%20Returns%20%E7%9A%84%E5%AF%B9%E6%AF%94/index.html">
<meta property="og:site_name" content="åˆ˜æ–‡é‘«-ä¸ªäººåšå®¢">
<meta property="og:description" content="Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”ã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162446530.png">
<meta property="og:image" content="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162521843.png">
<meta property="og:image" content="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162550437.png">
<meta property="article:published_time" content="2025-11-05T09:00:00.000Z">
<meta property="article:modified_time" content="2025-11-05T09:19:33.273Z">
<meta property="article:author" content="åˆ˜æ–‡é‘«">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162446530.png">
  
    <link rel="alternate" href="/blog/atom.xml" title="åˆ˜æ–‡é‘«-ä¸ªäººåšå®¢" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/blog/css/images/L-logo-transparent.png">
  
  
  
<link rel="stylesheet" href="/blog/css/style.css">

  
    
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.min.css">

  
  
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.2.0/css/fork-awesome.min.css">

<meta name="generator" content="Hexo 8.0.0"><link rel="stylesheet" href="/blog/css/prism.css" type="text/css"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">åˆ˜æ–‡é‘«</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/blog/" id="subtitle">è®°å½•ä¸åˆ†äº«</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
          <a class="main-nav-link" href="/blog/about">About</a>
        
      </nav>
      <nav id="sub-nav">
        
          
            <a class="nav-icon" target="_blank" rel="noopener" href="https://github.com/llwx2324"><span class="fa fa-github"></span></a>
          
        
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
        <div id="search-form-wrap">
          
<div class="search-form">
  <input id="search-input" type="search" placeholder="æœç´¢æœ¬ç«™æ–‡ç« ..." autocomplete="off">
  <ul id="search-results"></ul>
</div>

        </div>
      </nav>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/blog/2025/11/05/Spring%20AMQP%20%E4%B8%8B%20Publisher%20Confirms%20%E5%92%8C%20Publisher%20Returns%20%E7%9A%84%E5%AF%B9%E6%AF%94/" class="article-date">
  <time class="dt-published" datetime="2025-11-05T09:00:00.000Z" itemprop="datePublished">2025-11-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<p><code>ReturnCallback</code> å’Œ <code>ConfirmCallback</code> æ˜¯åœ¨ä½¿ç”¨ Spring AMQPï¼ˆSpring Data RabbitMQï¼‰æ¡†æ¶æ—¶ï¼Œå¯¹æ ‡å‡† RabbitMQ å®¢æˆ·ç«¯çš„ <code>ReturnListener</code> å’Œ <code>ConfirmListener</code> æœºåˆ¶è¿›è¡Œçš„é«˜çº§å°è£…ã€‚</p>
<p>å®ƒä»¬æ˜¯ Spring Boot&#x2F;Spring Cloud åº”ç”¨ä¸­å®ç°æ¶ˆæ¯å¯é æ€§çš„<strong>æ ¸å¿ƒæ¥å£</strong>ã€‚</p>
<hr>
<h3 id="1-ğŸ”„-ConfirmCallback-å¯¹åº”-Publisher-Confirms"><a href="#1-ğŸ”„-ConfirmCallback-å¯¹åº”-Publisher-Confirms" class="headerlink" title="1. ğŸ”„ ConfirmCallback (å¯¹åº” Publisher Confirms)"></a>1. ğŸ”„ ConfirmCallback (å¯¹åº” Publisher Confirms)</h3><p><code>ConfirmCallback</code> æ¥å£ç”¨äºå¤„ç† <strong>ç”Ÿäº§è€…ç¡®è®¤ï¼ˆPublisher Confirmsï¼‰</strong> çš„ç»“æœã€‚å®ƒå‘Šè¯‰ç”Ÿäº§è€…æ¶ˆæ¯æ˜¯å¦å·²è¢« RabbitMQ Broker æˆåŠŸæ¥æ”¶ã€‚</p>
<h4 id="å…³æ³¨ç‚¹"><a href="#å…³æ³¨ç‚¹" class="headerlink" title="å…³æ³¨ç‚¹"></a>å…³æ³¨ç‚¹</h4><ul>
<li><strong>å…³æ³¨é˜¶æ®µï¼š</strong> ç”Ÿäº§è€… $\rightarrow$ Brokerã€‚</li>
<li><strong>å¦‚ä½•ä½¿ç”¨ï¼š</strong> å°†è¯¥å›è°ƒå®ç°ç±»åŠ åˆ° <code>correlationData</code> çš„<code>future</code>ä¸­ï¼ˆæ¯æ¬¡å‘æ¶ˆæ¯éƒ½è¦æŒ‡å®šï¼Œå› æ­¤ä¸€èˆ¬æ˜¯å†™åœ¨ä¸šåŠ¡ä»£ç ä¸­ï¼‰ã€‚</li>
<li><strong>æ ¸å¿ƒé€»è¾‘ï¼š</strong><ul>
<li>å¦‚æœ <code>ack</code> ä¸º <code>true</code>ï¼šè¡¨ç¤ºæ¶ˆæ¯å®‰å…¨åˆ°è¾¾ Brokerï¼Œå¯ä»¥ä»é‡å‘é˜Ÿåˆ—æˆ–å†…å­˜ä¸­ç§»é™¤è¿™æ¡æ¶ˆæ¯ã€‚</li>
<li>å¦‚æœ <code>ack</code> ä¸º <code>false</code>ï¼šè¡¨ç¤ºæ¶ˆæ¯æœªèƒ½è¢« Broker æ¥æ”¶ï¼ˆé€šå¸¸æ˜¯ç½‘ç»œé—®é¢˜æˆ– Broker å†…éƒ¨é”™è¯¯ï¼‰ï¼Œéœ€è¦æ ¹æ® <code>correlationData</code> å°è¯•<strong>é‡å‘</strong>æˆ–è®°å½•å¤±è´¥æ—¥å¿—ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h3 id="2-â†©ï¸-ReturnCallback-å¯¹åº”-Publisher-Returns"><a href="#2-â†©ï¸-ReturnCallback-å¯¹åº”-Publisher-Returns" class="headerlink" title="2. â†©ï¸ ReturnCallback (å¯¹åº” Publisher Returns)"></a>2. â†©ï¸ ReturnCallback (å¯¹åº” Publisher Returns)</h3><p><code>ReturnCallback</code> æ¥å£ç”¨äºå¤„ç† <strong>ç”Ÿäº§è€…è¿”å›ï¼ˆPublisher Returnsï¼‰</strong> çš„äº‹ä»¶ã€‚å®ƒå‘Šè¯‰ç”Ÿäº§è€…æ¶ˆæ¯è™½ç„¶è¢« Broker æ¥æ”¶äº†ï¼Œä½† Exchange æ— æ³•å°†å…¶è·¯ç”±åˆ°ä»»ä½•é˜Ÿåˆ—ã€‚</p>
<h4 id="å…³æ³¨ç‚¹-1"><a href="#å…³æ³¨ç‚¹-1" class="headerlink" title="å…³æ³¨ç‚¹"></a>å…³æ³¨ç‚¹</h4><ul>
<li><strong>å…³æ³¨é˜¶æ®µï¼š</strong> Exchange $\rightarrow$ Queueã€‚</li>
<li><strong>å¦‚ä½•ä½¿ç”¨ï¼š</strong> å°†è¯¥å›è°ƒå®ç°ç±»æ³¨å…¥åˆ° Spring çš„ <code>RabbitTemplate</code> ä¸­ï¼ˆåªèƒ½é…ç½®ä¸€ä¸ªï¼Œé…ç½®ç±»ä¸­é…ç½®ï¼‰</li>
<li><strong>æ ¸å¿ƒé€»è¾‘ï¼š</strong><ul>
<li>è¯¥å›è°ƒæ–¹æ³•è¢«è°ƒç”¨ï¼Œæ„å‘³ç€<strong>æ¶ˆæ¯å·²ä¸¢å¤±</strong>ï¼ˆæ— æ³•è¢«æ¶ˆè´¹è€…è·å–ï¼‰ã€‚</li>
<li>ç”Ÿäº§è€…åº”æ£€æŸ¥ <code>replyText</code> å’Œ <code>routingKey</code>ï¼Œé€šå¸¸éœ€è¦è®°å½•è¯¦ç»†æ—¥å¿—ï¼Œç„¶åå°† <code>message</code> <strong>é‡æ–°å‘é€</strong>åˆ°å¤‡ç”¨ Exchange æˆ–äººå·¥å¤„ç†é˜Ÿåˆ—ï¼Œä»¥é˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚</li>
</ul>
</li>
</ul>
<hr>
<h3 id="ğŸ“Š-æ€»ç»“å¯¹æ¯”-Spring-AMQP-è§†è§’"><a href="#ğŸ“Š-æ€»ç»“å¯¹æ¯”-Spring-AMQP-è§†è§’" class="headerlink" title="ğŸ“Š æ€»ç»“å¯¹æ¯” (Spring AMQP è§†è§’)"></a>ğŸ“Š æ€»ç»“å¯¹æ¯” (Spring AMQP è§†è§’)</h3><table>
<thead>
<tr>
<th><strong>ç‰¹æ€§</strong></th>
<th><strong>ConfirmCallback</strong></th>
<th><strong>ReturnCallback</strong></th>
</tr>
</thead>
<tbody><tr>
<td><strong>åº•å±‚å¯¹åº”</strong></td>
<td>Publisher Confirms (Ack&#x2F;Nack)</td>
<td>Publisher Returns</td>
</tr>
<tr>
<td><strong>ä½•æ—¶è§¦å‘</strong></td>
<td>æ¶ˆæ¯è¢« <strong>Broker æ¥æ”¶&#x2F;æ‹’ç»</strong> æ—¶</td>
<td>æ¶ˆæ¯è¢« <strong>Exchange æ¥æ”¶</strong> ä¸” <strong>æ— æ³•è·¯ç”±</strong> åˆ°ä»»ä½•é˜Ÿåˆ—æ—¶</td>
</tr>
<tr>
<td><strong>å…³æ³¨é‡ç‚¹</strong></td>
<td><strong>æ¥æ”¶çš„å®‰å…¨æ€§</strong></td>
<td><strong>è·¯ç”±çš„å‡†ç¡®æ€§</strong></td>
</tr>
<tr>
<td><strong>æ ¸å¿ƒå‚æ•°</strong></td>
<td><code>ack</code> (å¸ƒå°”å€¼) å’Œ <code>cause(reason)</code></td>
<td><code>message</code> å’Œ <code>replyCode</code>&#x2F;<code>replyText</code></td>
</tr>
<tr>
<td><strong>å…¸å‹å¤„ç†</strong></td>
<td>Ack: æ¸…é™¤è®°å½•ï¼›Nack: <strong>é‡å‘</strong>æ¶ˆæ¯</td>
<td>è®°å½•æ—¥å¿—å¹¶å†³å®šæ˜¯å¦ <strong>é‡æ–°è·¯ç”±</strong></td>
</tr>
</tbody></table>
<p><strong>é‡è¦æç¤ºï¼š</strong></p>
<p>åœ¨ Spring AMQP ä¸­ï¼Œè¿™ä¸¤ä¸ªå›è°ƒå‡½æ•°æ˜¯å®ç°<strong>ç«¯åˆ°ç«¯å¯é æ€§</strong>çš„é»„é‡‘æ­æ¡£ã€‚å®ƒä»¬ä½¿ä¸šåŠ¡é€»è¾‘èƒ½å¤Ÿæ¸…æ™°åœ°å¤„ç†æ¶ˆæ¯å‘é€è¿‡ç¨‹ä¸­çš„æ‰€æœ‰å¼‚å¸¸æƒ…å†µã€‚</p>
<p><strong>ä½¿ç”¨æ­¥éª¤</strong>ï¼š</p>
<p>1.<img src="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162446530.png" alt="image-20251105162446530"></p>
<p>2.<img src="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162521843.png" alt="image-20251105162521843"></p>
<ol start="3">
<li></li>
</ol>
<p><img src="https://ye-hai.oss-cn-shenzhen.aliyuncs.com/typora/image-20251105162550437.png" alt="image-20251105162550437"></p>
<p>ï¼<strong>ä½†æ˜¯ä»¥ä¸Šæœºåˆ¶éƒ½ä¸€èˆ¬ä¸ä¼šå¼€å¯</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://llwx2324.github.io/blog/2025/11/05/Spring%20AMQP%20%E4%B8%8B%20Publisher%20Confirms%20%E5%92%8C%20Publisher%20Returns%20%E7%9A%84%E5%AF%B9%E6%AF%94/" data-id="cuidr1EleCcUhrkDQhvLG6nir" data-title="Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2025/11/06/%E5%9B%9E%E6%BA%AF%E6%B3%95/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          å›æº¯æ³•
        
      </div>
    </a>
  
  
    <a href="/blog/2025/11/03/Gemini%20CLI%E6%97%A0%E6%B3%95%E7%99%BB%E5%BD%95%E7%9A%84%E9%97%AE%E9%A2%98/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Gemini CLIæ— æ³•ç™»å½•çš„é—®é¢˜</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2025/11/">November 2025</a></li><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2025/10/">October 2025</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/blog/2025/11/08/Maven%20%E6%A0%B8%E5%BF%83%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB/">Maven æ ¸å¿ƒçŸ¥è¯†ä½“ç³»</a>
          </li>
        
          <li>
            <a href="/blog/2025/11/08/component%E4%B8%8E%E9%85%8D%E7%BD%AE%E7%B1%BB%E6%B3%A8%E5%86%8Cbean%E7%9A%84%E5%8C%BA%E5%88%AB%EF%BC%88%E7%BB%93%E5%90%88%E5%AE%9E%E9%99%85%E5%9C%BA%E6%99%AF%EF%BC%89%E3%80%81maven%E4%BD%9C%E7%94%A8%E5%9F%9F/">componentä¸é…ç½®ç±»æ³¨å†Œbeançš„åŒºåˆ«ï¼ˆç»“åˆå®é™…åœºæ™¯ï¼‰ã€mavenä½œç”¨åŸŸ</a>
          </li>
        
          <li>
            <a href="/blog/2025/11/06/%E5%9B%9E%E6%BA%AF%E6%B3%95/">å›æº¯æ³•</a>
          </li>
        
          <li>
            <a href="/blog/2025/11/05/Spring%20AMQP%20%E4%B8%8B%20Publisher%20Confirms%20%E5%92%8C%20Publisher%20Returns%20%E7%9A%84%E5%AF%B9%E6%AF%94/">Spring AMQP ä¸‹ Publisher Confirms å’Œ Publisher Returns çš„å¯¹æ¯”</a>
          </li>
        
          <li>
            <a href="/blog/2025/11/03/Gemini%20CLI%E6%97%A0%E6%B3%95%E7%99%BB%E5%BD%95%E7%9A%84%E9%97%AE%E9%A2%98/">Gemini CLIæ— æ³•ç™»å½•çš„é—®é¢˜</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 åˆ˜æ–‡é‘«<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">Home</a>
  
    <a href="/blog/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/blog/about" class="mobile-nav-link">About</a>
  
</nav>
    


<script src="/blog/js/jquery-3.6.4.min.js"></script>



  
<script src="/blog/fancybox/jquery.fancybox.min.js"></script>




<script src="/blog/js/script.js"></script>




<script src="/blog/js/search.js" data-root="/blog/"></script>


  </div>
</body>
</html>